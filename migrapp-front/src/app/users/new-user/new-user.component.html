<h1 class="title">Crear Nuevo Usuario</h1>

  <form (ngSubmit)="onSubmit()" #userForm="ngForm" class="form-grid">

    <!-- Email -->
    <mat-form-field appearance="outline" class="full-2">
      <mat-label>Email</mat-label>
      <input matInput type="email" name="email" required [(ngModel)]="newUser.email">
    </mat-form-field>

    <!-- Nombre -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nombre</mat-label>
      <input matInput type="text" name="name" required [(ngModel)]="newUser.name">
    </mat-form-field>

    <!-- Apellido -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Apellido</mat-label>
      <input matInput type="text" name="lastName" required [(ngModel)]="newUser.lastName">
    </mat-form-field>

    <!-- País -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>País</mat-label>
      <input matInput type="text" name="country" required [(ngModel)]="newUser.country">
    </mat-form-field>

    <!-- Prefijo Teléfono -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Prefijo Teléfono</mat-label>
      <input matInput type="text" name="phonePrefix" required [(ngModel)]="newUser.phonePrefix">
    </mat-form-field>

    <!-- Número Teléfono -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Teléfono</mat-label>
      <input matInput type="text" name="phone" required [(ngModel)]="newUser.phone">
    </mat-form-field>

    <!-- Contraseña -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Contraseña</mat-label>
      <input matInput type="password" name="password" required [(ngModel)]="newUser.password">
    </mat-form-field>

    <!-- Confirmar Contraseña -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Confirmar Contraseña</mat-label>
      <input matInput type="password" name="confirmPassword" required [(ngModel)]="newUser.confirmPassword">
    </mat-form-field>

    <!-- Tipo de Usuario -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Tipo de Usuario</mat-label>
      <mat-select name="userType" required [(ngModel)]="newUser.userType">
        <mat-option value="admin">Administrador</mat-option>
        <mat-option value="lawyer">Abogado</mat-option>
        <mat-option value="auditor">Auditor</mat-option>
        <mat-option value="reader">Lector</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Ingreso de IDs de Usuarios Asignados: solo se muestra si el checkbox está seleccionado -->
    <mat-form-field *ngIf="!newUser.hasAccessToAllUsers" appearance="outline" class="full-width">
      <mat-label>Selecciona los usuarios asignados</mat-label>
      <mat-select [(ngModel)]="newUser.assignedUserIds" name="assignedUserIds" multiple>
        <mat-option *ngFor="let user of availableUsers" [value]="user.id">
          {{ user.name }} {{ user.lastName }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Acceso a todos los usuarios -->
    <mat-checkbox [(ngModel)]="newUser.hasAccessToAllUsers" name="hasAccessToAllUsers">
      Acceso a todos los usuarios
    </mat-checkbox>

    <!-- Botones -->
    <div class="button-group full-2">
      <button mat-flat-button color="primary" type="submit" [disabled]="userForm.invalid">Guardar</button>
      <button mat-stroked-button color="warn" routerLink="/users">Cancelar</button>
    </div>

  </form>